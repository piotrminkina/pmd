{% set attrs = {} %}
{% set block_tag = block_tag|default('section') %}
{% set block_body = block_body|default(block('body')|trim) %}
{% set block_attrs = block_attrs|default({}) %}
{% set block_attrs = block_attrs|merge({class: ('block ' ~ block_attrs.class|default(''))|trim}) %}

{% block block %}
    {% set attrs = block_attrs %}

    <{{ block_tag }} {{ block('block_attrs') }}>
        {% block block_content %}
            {% block block_body %}
                {% block block_body_content %}
                    {{ block_body|raw }}
                {% endblock %}
            {% endblock %}
        {% endblock %}
    </{{ block_tag }}>
{% endblock %}

{% block block_attrs %}
    {%- for name, value in attrs -%}
        {{- name }}="{{ value }}"
    {%- endfor -%}
{% endblock block_attrs %}
